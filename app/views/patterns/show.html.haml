- title @pattern.name

%h2 Signs and Symptoms
Keys: #{@pattern.pattern_symptoms.select{|x| x.key_symptom}.map{|y| y.symptom_name}.join(", ")}

%ul
  - @pattern.pattern_symptoms.each do |s|
    %li
      - if s.maybe
        (possibly)
      - if s.key_symptom
        %i= s.symptom_name
      - else
        = s.symptom_name
      - unless s.commentary.blank?
        %ul
          %li
            :tcmtextile
              #{s.commentary}


%h2 Treatment Principles
%ul
  - @pattern.pattern_treatment_principles.each do |p|
    %li
      = p.treatment_principle_name
      - unless p.commentary.blank?
        %ul
          %li
            :tcmtextile
              #{p.commentary}

- unless @pattern.commentary.blank?
  %h2 Commentary
  :tcmtextile
    #{@pattern.commentary}

- unless @pattern.pattern_formulas.blank?
  %h2 Formulas
  %ul
    - @pattern.pattern_formulas.each do |pf|
      %li!= "#{link_to pf.formula_pinyin, pf.formula} (#{pf.citation.textbook.title})"

- unless @pattern.point_prescriptions.blank?
  - @pattern.point_prescriptions.each do |pp|
    %h2!= "Point Prescription: #{pp.citation.textbook_title if pp.citation} #{link_to "edit", edit_point_prescription_path(pp)}"
    %ul
      - pp.pp_acu_points.each do |ap|
        %li!= "#{ap.acu_point_abbrev} (#{ap.commentary})"


- if can? :update, @pattern
  = link_to 'Edit', edit_pattern_path(@pattern)