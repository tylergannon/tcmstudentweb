= f.error_messages
%h2
  Name
%table
  %tr
    %td
      = f.label :pinyin
      \:
      = f.text_field :pinyin, :autocomplete => "off"
    %td
      = f.label :english
      \:
      = f.text_field :english, :autocomplete => "off"
    %td
      = f.label :chinese
      \:
      = f.text_field :chinese, :autocomplete => "off"
    %td
      #{f.label :state_board}:#{f.check_box :state_board}
%b Tags
= tag_field(f, :tag_list)
%br/

%h2
  Category
!= f.text_field_with_auto_complete :formula_category_name, {},  { :url => formula_categories_path(:format => :js), :method => :get, :skip_style => false,  :with => "'search='+element.value" }
%hr
%h2
  Ingredients
= add_child_link 'Add an Herb', 'formula_herb', f
%ul#formula_herb_children
  = f.fields_for :formula_herbs do |formula_herb_form|
    = render :partial => 'formula_herb', :locals => { :f => formula_herb_form }

= sortable_element "formula_herb_children", :url => sort_formulas_path
%hr
%h2 Source
%table
  %tr
    %td
      = render :partial => 'citations/edit_citation', :locals => {:f => f, :field => :citation}
    %td
      = render :partial => 'citations/edit_citation', :locals => {:f => f, :field => :source_text_citation}

%hr
%h2 Therapeutic Functions
= text_area_with_auto_complete f, :formula_therapeutic_functions_text, "therapeutic_functions", :rows => 2, :cols => 50

%hr
%h2
  Diagnosis
= add_child_link 'Add a Pattern of Disharmony', 'formula_pattern', f
#formula_pattern_children
  = f.fields_for :formula_patterns do |formula_pattern_form|
    = render :partial => 'formula_pattern', :locals => { :f => formula_pattern_form }

%hr
%h2
  Cautions and Contraindications
= add_child_link 'Add a FormulaContraindication', 'formula_contraindication', f
#formula_contraindication_children
  = f.fields_for :formula_contraindications do |formula_contraindication_form|
    = render :partial => 'formula_contraindication', :locals => { :f => formula_contraindication_form }

%hr
%h2
  Preparation
= f.text_area :preparation, :rows => 2, :cols => 40
%hr
%h2
  Commentary
= f.text_area :commentary
%hr/
%h2 Comparisons
#formula_comparison_children
  = f.fields_for :formula_comparisons do |formula_comparison_form|
    = render :partial => 'formula_comparison', :locals => { :f => formula_comparison_form }

%p
  = add_child_link 'Add a Comparison', 'formula_comparison', f

%hr/
%h2 Dui Yao
#formula_dui_yao_children
  = f.fields_for :formula_dui_yaos do |formula_dui_yao_form|
    = render :partial => 'formula_dui_yao', :locals => { :f => formula_dui_yao_form }
%p
  = add_child_link 'Add a Dui Yao', 'formula_dui_yao', f

